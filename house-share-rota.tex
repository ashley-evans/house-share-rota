\documentclass[DIV=13, landscape]{scrartcl}
\usepackage{graphicx, cals}
\usepackage{changepage}
\usepackage{pdflscape}
\usepackage[british]{babel}
\usepackage[useregional, calc, datesep=/]{datetime2}
\usepackage{pgffor}
\usepackage{arrayjob}
\usepackage{intcalc}

% Function: Add Days
\newcount\daycount
\newcommand{\AddDays}[2]{%
	\DTMsavedate{CurrentDate}{#1}%
	\DTMsaveddateoffsettojulianday{CurrentDate}{#2}\daycount%
	\DTMsavejulianday{CurrentDate}{\number\daycount}%
	\DTMusedate{CurrentDate}%
}%

% Update date here to change initial date of rota. ISO Format.
% The initial date is the start date of the first rota produced.
\newcommand{\InitialDate}{2020-07-20}

\DTMsavedate{InitialDate}{\InitialDate}

% Initial array order for initial date.
\newarray\initials
\readarray{initials}{A&F&So&Si&G&J&V}

% Update date here to change start date of rota. ISO Format.
% The start date is for the rota being currently produced.
\newcommand{\StartDate}{2020-07-20}

\DTMsavedate{StartDate}{\StartDate}

% Calculate difference between initial and start to offset array order.
\newcount\offsetdaycount
\DTMsaveddatediff{StartDate}{InitialDate}{\offsetdaycount}

% Update here to change number of days to display past initial date.
\newcommand{\DaysToDisplay}{13}

\begin{document}

% Remove Page Number
\thispagestyle{empty}

\textbf{Rota for: \DTMusedate{StartDate} - \AddDays{\StartDate}{\DaysToDisplay}}

\begin{calstable}[c]
	\makeatletter
	
	% Define cell border widths
	\def\cals@cs@width{1pt}
	\def\cals@rs@width{1pt}
	
	% Define frame border widths
	\def\cals@framers@width{1pt}
	\def\cals@framecs@width{1pt}
	
	% Define cell background colour to default empty
	\def\cals@bgcolor{}
	
	% Handle column sizing.	
	\colwidths{
		{\dimexpr(\columnwidth)/78*30\relax} % Date Column Size
		{\dimexpr(\columnwidth)/78*8\relax} % Task 1 Column Size
		{\dimexpr(\columnwidth)/78*8\relax} % Task 2 Column Size
		{\dimexpr(\columnwidth)/78*8\relax} % Task 3 Column Size
		{\dimexpr(\columnwidth)/78*8\relax} % Task 4 Column Size
		{\dimexpr(\columnwidth)/78*8\relax} % Task 5 Column Size
		{\dimexpr(\columnwidth)/78*8\relax} % Task 6 Column Size
	}
	
	% Header rows
	\thead{
		% Header row 1 
		\brow
			\nullcell{tlr}
			
			\nullcell{tlb}
			\nullcell{tb}
			\nullcell{tb}
			\nullcell{tb}
			\nullcell{tb}
			\nullcell{trb} \alignC \spancontent{\textbf{Tasks}}
		\erow
		
		% Header row 2
		\brow
			\nullcell{tlbr} \alignC \spancontent{\vfill \textbf{Date}}
			
			\cell{\vfil \rotatebox[origin=c]{90}{\textbf{Change Bins}}} \alignC
			\cell{\vfil \rotatebox[origin=c]{90}{\textbf{Sweep Floor}}} \alignC
			\cell{\vfil \rotatebox[origin=c]{90}{\textbf{Wipe Surfaces}}} \alignC
			\cell{\vfil \rotatebox[origin=c]{90}{\textbf{Wipe appliances}}} \alignC
			\cell{\vfil \rotatebox[origin=c]{90}{\textbf{Clean Microwave}}} \alignC
			\cell{\vfil \rotatebox[origin=c]{90}{\textbf{Handle Dishwasher}}} \alignC
		\erow
	}
	
	% Body Rows
	\foreach \n in {0,...,\DaysToDisplay}
	{
		\newcommand{\offsetN}{\intcalcAdd{\n}{\number\offsetdaycount}}	
	
		\brow
			\cell{\textbf{\AddDays{\InitialDate}{\offsetN}}}

			\cell{\initials(\intcalcAdd{\intcalcMod{0 - \offsetN}{7}}{1})}
			\cell{\initials(\intcalcAdd{\intcalcMod{1 - \offsetN}{7}}{1})}
			\cell{\initials(\intcalcAdd{\intcalcMod{2 - \offsetN}{7}}{1})}
			\cell{\initials(\intcalcAdd{\intcalcMod{3 - \offsetN}{7}}{1})}
			\cell{\initials(\intcalcAdd{\intcalcMod{4 - \offsetN}{7}}{1})}
			\cell{\initials(\intcalcAdd{\intcalcMod{5 - \offsetN}{7}}{1})}
		\erow
	}%
\end{calstable}

\end{document}
